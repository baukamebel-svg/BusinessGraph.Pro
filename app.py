import streamlit as st
import pandas as pd
import plotly.graph_objects as go

# -------------------------
# App settings
# -------------------------
st.set_page_config(
    page_title="BusinessGraph Pro",
    page_icon="üìà",
    layout="wide"
)

# -------------------------
# Language pack
# -------------------------
LANG = st.sidebar.selectbox("–¢—ñ–ª / –Ø–∑—ã–∫", ["“ö–∞–∑–∞“õ—à–∞", "–†—É—Å—Å–∫–∏–π"])

TEXT = {
    "“ö–∞–∑–∞“õ—à–∞": {
        "title": "BusinessGraph Pro ‚Äì –∑–∞–ª–∞–ª—Å—ã–∑–¥—ã“õ –Ω“Ø–∫—Ç–µ—Å—ñ–Ω –µ—Å–µ–ø—Ç–µ—É “õ“±—Ä–∞–ª—ã",
        "author": "–ê–í–¢–û–†–´: –ê–±–∏–ª—å–¥–∞–µ–≤–∞ –ê–π–∞—Ä—É, –ï—Ä–∞–ª–∏–µ–≤–∞ –ê–π–±–∏–±—ñ (–ê—Ä–∞–ª –∞—É–¥–∞–Ω—ã ‚Ññ71 –º–µ–∫—Ç–µ–ø)",
        "desc": "–ö”ô—Å—ñ–ø–∫–µ—Ä–ª–µ—Ä–≥–µ –∞—Ä–Ω–∞–ª“ì–∞–Ω ”©–Ω—ñ–º–¥–µ—Ä–¥—ñ“£ –∞–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω–¥–∞—Ä—ã, –±–∞“ì–∞—Å—ã –∂”ô–Ω–µ –∫”ô—Å—ñ–ø–æ—Ä—ã–Ω–Ω—ã“£ —Ç“±—Ä–∞“õ—Ç—ã —à—ã–Ω—ã –Ω–µ–≥—ñ–∑—ñ–Ω–¥–µ –∑–∞–ª–∞–ª—Å—ã–∑–¥—ã“õ –Ω“Ø–∫—Ç–µ—Å—ñ–Ω –µ—Å–µ–ø—Ç–µ–ø, –≥—Ä–∞—Ñ–∏–∫ —Ç“Ø—Ä—ñ–Ω–¥–µ –∫”©—Ä—Å–µ—Ç–µ—Ç—ñ–Ω –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—Ç—ñ “õ“±—Ä–∞–ª.",
        "product_block": "1-“õ–∞–¥–∞–º: ”®–Ω—ñ–º–¥—ñ –∂”ô–Ω–µ –∞–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω–¥–∞—Ä–¥—ã –µ–Ω–≥—ñ–∑—É",
        "product_name": "”®–Ω—ñ–º –∞—Ç–∞—É—ã (–º—ã—Å–∞–ª—ã: —Ç–æ—Ä—Ç, –∫–µ–∫—Å, —à–∫–∞—Ñ...)",
        "var_items_label": "”®–Ω—ñ–º–≥–µ –∫–µ—Ç–µ—Ç—ñ–Ω –∞–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω–¥–∞—Ä (–∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—Ç–µ—Ä —Ç—ñ–∑—ñ–º—ñ)",
        "var_help": "”®–∑–≥–µ—Ä–º–µ–ª—ñ —à—ã“ì—ã–Ω ‚Äì –±—ñ—Ä ”©–Ω—ñ–º–Ω—ñ“£ ”ô—Ä –¥–∞–Ω–∞—Å—ã–Ω –∂–∞—Å–∞“ì–∞–Ω–¥–∞ –±—ñ—Ä–≥–µ ”©–∑–≥–µ—Ä–µ—Ç—ñ–Ω —à—ã“ì—ã–Ω. –ú—ã—Å–∞–ª—ã: “±–Ω, —à–µ–∫–µ—Ä, –∂“±–º—ã—Ä—Ç“õ–∞, “õ–∞–ø—Ç–∞–º–∞, –∂–µ—Ç–∫—ñ–∑—É. ”ò—Ä –∂–æ–ª–¥—ã \"–∞—Ç–∞—É = —Å–æ–º–∞\" —Ç“Ø—Ä—ñ–Ω–¥–µ –∂–∞–∑—ã“£—ã–∑.\n–ú—ã—Å–∞–ª:\n“±–Ω = 1000\n—à–µ–∫–µ—Ä = 200\n–∂“±–º—ã—Ä—Ç“õ–∞ = 300",
        "var_total": "–ñ–∞–ª–ø—ã –∞–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω (1 –¥–∞–Ω–∞“ì–∞):",
        "price_label": "–°–∞—Ç—É –±–∞“ì–∞—Å—ã (1 –¥–∞–Ω–∞, —Ç–µ“£–≥–µ)",
        "save_product": "”®–Ω—ñ–º–¥—ñ —Ç—ñ–∑—ñ–º–≥–µ “õ–æ—Å—É",
        "products_table": "“ö–æ—Å—ã–ª“ì–∞–Ω ”©–Ω—ñ–º–¥–µ—Ä —Ç—ñ–∑—ñ–º—ñ",
        "no_products": "–ê–ª–¥—ã–º–µ–Ω –∫–µ–º—ñ–Ω–¥–µ –±—ñ—Ä ”©–Ω—ñ–º “õ–æ—Å—ã“£—ã–∑.",
        "fixed_block": "2-“õ–∞–¥–∞–º: –¢“±—Ä–∞“õ—Ç—ã —à—ã“ì—ã–Ω–¥–∞—Ä–¥—ã –µ–Ω–≥—ñ–∑—É",
        "fixed_items_label": "–¢“±—Ä–∞“õ—Ç—ã —à—ã“ì—ã–Ω –±–∞–ø—Ç–∞—Ä—ã (–∞–π—ã–Ω–∞/–∫–µ–∑–µ“£–≥–µ)",
        "fixed_help": "–¢“±—Ä–∞“õ—Ç—ã —à—ã“ì—ã–Ω ‚Äì ”©–Ω–¥—ñ—Ä—ñ—Å –∫”©–ª–µ–º—ñ–Ω–µ —Ç—ñ–∫–µ–ª–µ–π –±–∞–π–ª–∞–Ω—ã—Å—ã –∂–æ“õ, –∞–π —Å–∞–π—ã–Ω –Ω–µ–º–µ—Å–µ –∫–µ–∑–µ“£ —Å–∞–π—ã–Ω —Å–∞–ª—ã—Å—Ç—ã—Ä–º–∞–ª—ã —Ç“Ø—Ä–¥–µ ”©–∑–≥–µ—Ä–º–µ–π—Ç—ñ–Ω —à—ã“ì—ã–Ω–¥–∞—Ä. –ú—ã—Å–∞–ª—ã: –∞—Ä–µ–Ω–¥–∞, –Ω–µ–≥—ñ–∑–≥—ñ –∂–∞–ª–∞“õ—ã, –∫–æ–º–º—É–Ω–∞–ª–¥—ã“õ –º–∏–Ω–∏–º—É–º, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –∫“Ø–∑–µ—Ç.\n”ò—Ä –∂–æ–ª–¥—ã \"–∞—Ç–∞—É = —Å–æ–º–∞\" —Ç“Ø—Ä—ñ–Ω–¥–µ –∂–∞–∑—ã“£—ã–∑.\n–ú—ã—Å–∞–ª:\n–∞—Ä–µ–Ω–¥–∞ = 150000\n–∂–∞–ª–∞“õ—ã = 200000\n–∫–æ–º–º—É–Ω–∞–ª–¥—ã“õ = 50000",
        "fixed_total": "–ñ–∞–ª–ø—ã —Ç“±—Ä–∞“õ—Ç—ã —à—ã“ì—ã–Ω (FC):",
        "graph_block": "3-“õ–∞–¥–∞–º: –ì—Ä–∞—Ñ–∏–∫ –∂”ô–Ω–µ —Ç–∞–ª–¥–∞—É",
        "select_product": "–ì—Ä–∞—Ñ–∏–∫ —Å–∞–ª—É “Ø—à—ñ–Ω ”©–Ω—ñ–º–¥—ñ —Ç–∞“£–¥–∞“£—ã–∑",
        "graph_title": "–ó–∞–ª–∞–ª—Å—ã–∑–¥—ã“õ –≥—Ä–∞—Ñ–∏–≥—ñ: —Ç“Ø—Å—ñ–º –º–µ–Ω —à—ã“ì—ã–Ω",
        "units": "”®–Ω—ñ–º —Å–∞–Ω—ã (–¥–∞–Ω–∞)",
        "revenue": "–¢“Ø—Å—ñ–º / –í—ã—Ä—É—á–∫–∞",
        "total_cost": "–ñ–∞–ª–ø—ã —à—ã“ì—ã–Ω / –û–±—â–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã",
        "break_even": "–ó–∞–ª–∞–ª—Å—ã–∑–¥—ã“õ –Ω“Ø–∫—Ç–µ—Å—ñ",
        "no_fixed": "–¢“±—Ä–∞“õ—Ç—ã —à—ã“ì—ã–Ω–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑.",
        "bad_price": "–ë–∞“ì–∞ –∞–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω–Ω–∞–Ω –∂–æ“ì–∞—Ä—ã –±–æ–ª—É—ã –∫–µ—Ä–µ–∫, ”ô–π—Ç–ø–µ—Å–µ –ø–∞–π–¥–∞ —à—ã“õ–ø–∞–π–¥—ã.",
        "advice_block": "–ñ–ò –Ω–µ–≥—ñ–∑—ñ–Ω–¥–µ–≥—ñ –ø–∞–π–¥–∞–ª—ã –∫–µ“£–µ—Å—Ç–µ—Ä",
        "advice_intro": "–¢”©–º–µ–Ω–¥–µ–≥—ñ –∫–µ“£–µ—Å—Ç–µ—Ä –∞“ì—ã–º–¥–∞“ì—ã –¥–µ—Ä–µ–∫—Ç–µ—Ä–≥–µ —Å“Ø–π–µ–Ω—ñ–ø –∞–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç“Ø—Ä–¥–µ –∂–∞—Å–∞–ª–¥—ã:",
        "bep_sentence": "‚Ä¢ –ë“±–ª –∂–∞“ì–¥–∞–π–¥–∞ –∫”ô—Å—ñ–ø–æ—Ä—ã–Ω —à–∞–º–∞–º–µ–Ω {q:.0f} ”©–Ω—ñ–º–Ω–µ–Ω –∫–µ–π—ñ–Ω –ø–∞–π–¥–∞ –∞–π–º–∞“ì—ã–Ω–∞ ”©—Ç–µ–¥—ñ.",
        "bep_price_up": "‚Ä¢ –ï–≥–µ—Ä –±–∞“ì–∞–Ω—ã 10% ”©—Å—ñ—Ä—Å–µ“£—ñ–∑ ({old_price:.0f} ‚Üí {new_price:.0f} —Ç–µ“£–≥–µ), –∑–∏—è–Ω—Å—ã–∑–¥—ã“õ –Ω“Ø–∫—Ç–µ—Å—ñ {old_q:.0f} ”©–Ω—ñ–º–Ω–µ–Ω {new_q:.0f} ”©–Ω—ñ–º–≥–µ –¥–µ–π—ñ–Ω —Ç”©–º–µ–Ω–¥–µ–π–¥—ñ.",
        "bep_min_price": "‚Ä¢ –ë–∞“ì–∞–Ω—ã {min_price:.0f} —Ç–µ“£–≥–µ–¥–µ–Ω —Ç”©–º–µ–Ω “õ–æ–π—Å–∞“£—ã–∑, “±–∑–∞“õ –º–µ—Ä–∑—ñ–º–¥–µ –ø–∞–π–¥–∞ –±–æ–ª–º–∞–π–¥—ã (”©–∑—ñ–Ω–¥—ñ–∫ “õ“±–Ω“ì–∞ —Ç—ã–º –∂–∞“õ—ã–Ω).",
        "bep_range": "‚Ä¢ –¢–∏—ñ–º–¥—ñ –±–∞“ì–∞ –¥–∏–∞–ø–∞–∑–æ–Ω—ã —à–∞–º–∞–º–µ–Ω {low:.0f}‚Äì{high:.0f} —Ç–µ“£–≥–µ –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ –¥–µ–ø “õ–∞—Ä–∞—Å—Ç—ã—Ä—É“ì–∞ –±–æ–ª–∞–¥—ã.",
        "info_select": "”®–Ω—ñ–º–¥—ñ —Ç–∞“£–¥–∞–ø, –∞–π–Ω—ã–º–∞–ª—ã –∂”ô–Ω–µ —Ç“±—Ä–∞“õ—Ç—ã —à—ã“ì—ã–Ω–¥–∞—Ä–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑.",
        "saved_ok": "‚úî ”®–Ω—ñ–º —Ç—ñ–∑—ñ–º–≥–µ “õ–æ—Å—ã–ª–¥—ã.",
        "saved_error": "”®–Ω—ñ–º –∞—Ç–∞—É—ã –º–µ–Ω –±–∞“ì–∞ –º—ñ–Ω–¥–µ—Ç—Ç—ñ —Ç“Ø—Ä–¥–µ —Ç–æ–ª—Ç—ã—Ä—ã–ª—É—ã –∫–µ—Ä–µ–∫."
    },
    "–†—É—Å—Å–∫–∏–π": {
        "title": "BusinessGraph Pro ‚Äì –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Ç–æ—á–∫–∏ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏",
        "author": "–ê–í–¢–û–†–´: –ê–±–∏–ª—å–¥–∞–µ–≤–∞ –ê–π—è—Ä—É, –ï—Ä–∞–ª–∏–µ–≤–∞ –ê–π–±–∏–±–∏ (–®–∫–æ–ª–∞ ‚Ññ71, –ê—Ä–∞–ª—å—Å–∫–∏–π —Ä–∞–π–æ–Ω)",
        "desc": "–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ—á–∫—É –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç, —Ü–µ–Ω—ã –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–∞.",
        "product_block": "–®–∞–≥ 1: –í–≤–æ–¥ —Ç–æ–≤–∞—Ä–∞ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç",
        "product_name": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ç–æ—Ä—Ç, –∫–µ–∫—Å, —à–∫–∞—Ñ...)",
        "var_items_label": "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ 1 –µ–¥–∏–Ω–∏—Ü—É (—Å–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤)",
        "var_help": "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã ‚Äì —ç—Ç–æ –∑–∞—Ç—Ä–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å—Ç—É—Ç –≤–º–µ—Å—Ç–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–∏–∑–≤–µ–¥—ë–Ω–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä: –º—É–∫–∞, —Å–∞—Ö–∞—Ä, —è–π—Ü–∞, —É–ø–∞–∫–æ–≤–∫–∞, –¥–æ—Å—Ç–∞–≤–∫–∞. –ü–∏—à–∏—Ç–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ \"–Ω–∞–∑–≤–∞–Ω–∏–µ = —Å—É–º–º–∞\".\n–ü—Ä–∏–º–µ—Ä:\n–º—É–∫–∞ = 1000\n—Å–∞—Ö–∞—Ä = 200\n—è–π—Ü–∞ = 300",
        "var_total": "–°—É–º–º–∞—Ä–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ 1 –µ–¥–∏–Ω–∏—Ü—É:",
        "price_label": "–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (–∑–∞ 1 —à—Ç, —Ç–µ–Ω–≥–µ)",
        "save_product": "–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ —Å–ø–∏—Å–æ–∫",
        "products_table": "–°–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤",
        "no_products": "–°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä.",
        "fixed_block": "–®–∞–≥ 2: –í–≤–æ–¥ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç",
        "fixed_items_label": "–°—Ç–∞—Ç—å–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç (–≤ –º–µ—Å—è—Ü/–∑–∞ –ø–µ—Ä–∏–æ–¥)",
        "fixed_help": "–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã ‚Äì —ç—Ç–æ –∑–∞—Ç—Ä–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–∞–±–æ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ–±—ä—ë–º–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞: –∞—Ä–µ–Ω–¥–∞, –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è —á–∞—Å—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—ã, –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –æ—Ö—Ä–∞–Ω–∞.\n–ü–∏—à–∏—Ç–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ \"–Ω–∞–∑–≤–∞–Ω–∏–µ = —Å—É–º–º–∞\".\n–ü—Ä–∏–º–µ—Ä:\n–∞—Ä–µ–Ω–¥–∞ = 150000\n–∑–∞—Ä–ø–ª–∞—Ç–∞ = 200000\n–∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ = 50000",
        "fixed_total": "–û–±—â–∏–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã (FC):",
        "graph_block": "–®–∞–≥ 3: –ì—Ä–∞—Ñ–∏–∫ –∏ –∞–Ω–∞–ª–∏–∑",
        "select_product": "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞",
        "graph_title": "–ì—Ä–∞—Ñ–∏–∫ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏: –≤—ã—Ä—É—á–∫–∞ –∏ –∑–∞—Ç—Ä–∞—Ç—ã",
        "units": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ (—à—Ç)",
        "revenue": "–í—ã—Ä—É—á–∫–∞",
        "total_cost": "–û–±—â–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã",
        "break_even": "–¢–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏",
        "no_fixed": "–í–≤–µ–¥–∏—Ç–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã.",
        "bad_price": "–¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã—à–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç, –∏–Ω–∞—á–µ –ø—Ä–∏–±—ã–ª—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.",
        "advice_block": "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—á—ë—Ç–æ–≤",
        "advice_intro": "–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ —Ç–µ–∫—É—â–∏–º –¥–∞–Ω–Ω—ã–º:",
        "bep_sentence": "‚Ä¢ –í –¥–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ –≤—ã—Ö–æ–¥–∏—Ç –≤ –∑–æ–Ω—É –ø—Ä–∏–±—ã–ª–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –ø–æ—Å–ª–µ {q:.0f} –µ–¥–∏–Ω–∏—Ü –ø—Ä–æ–¥—É–∫—Ü–∏–∏.",
        "bep_price_up": "‚Ä¢ –ï—Å–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å —Ü–µ–Ω—É –Ω–∞ 10% ({old_price:.0f} ‚Üí {new_price:.0f} —Ç–µ–Ω–≥–µ), —Ç–æ—á–∫–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–Ω–∏–∑–∏—Ç—Å—è —Å {old_q:.0f} –¥–æ {new_q:.0f} –µ–¥–∏–Ω–∏—Ü.",
        "bep_min_price": "‚Ä¢ –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—É –Ω–∏–∂–µ {min_price:.0f} —Ç–µ–Ω–≥–µ, –≤ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ –ø—Ä–∏–±—ã–ª—å –±—É–¥–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å.",
        "bep_range": "‚Ä¢ –†–∞–∑—É–º–Ω—ã–π —Ü–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ –∫–∞–∫ {low:.0f}‚Äì{high:.0f} —Ç–µ–Ω–≥–µ.",
        "info_select": "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä –∏ –≤–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã.",
        "saved_ok": "‚úî –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫.",
        "saved_error": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏ —Ü–µ–Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∫ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é."
    }
}

TR = TEXT[LANG]

# -------------------------
# Helpers
# -------------------------

def parse_cost_lines(text: str):
    """'–∞—Ç–∞—É = —Å–æ–º–∞' —Ñ–æ—Ä–º–∞—Ç—ã–Ω–¥–∞“ì—ã –∂–æ–ª–¥–∞—Ä–¥–∞–Ω –∂–∞–ª–ø—ã —Å–æ–º–∞–Ω—ã –µ—Å–µ–ø—Ç–µ—É."""
    total = 0.0
    items = []
    for line in text.splitlines():
        line = line.strip()
        if not line:
            continue
        # —Ç“Ø—Ä–ª—ñ –±”©–ª–≥—ñ—à—Ç–µ—Ä–¥—ñ “õ–æ–ª–¥–∞–Ω—ã–ø –∫”©—Ä–µ–º—ñ–∑
        for sep in ["=", ":", "-"]:
            if sep in line:
                name, val = line.split(sep, 1)
                name = name.strip()
                val = val.strip().replace(",", ".")
                try:
                    cost = float(val)
                    total += cost
                    items.append((name, cost))
                except ValueError:
                    pass
                break
        else:
            # –±”©–ª—É –º“Ø–º–∫—ñ–Ω –±–æ–ª–º–∞–¥—ã, –º“Ø–º–∫—ñ–Ω —Ç–∞–∑–∞ —Å–∞–Ω —à—ã“ì–∞—Ä
            v = line.replace(",", ".")
            try:
                cost = float(v)
                total += cost
                items.append(("", cost))
            except ValueError:
                pass
    return total, items

# -------------------------
# Header
# -------------------------
st.title("üìà BusinessGraph Pro")
st.caption(TR["author"])
st.write(TR["desc"])
st.markdown("---")

# -------------------------
# 1-“õ–∞–¥–∞–º: ”®–Ω—ñ–º –∂”ô–Ω–µ –∞–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω
# -------------------------
st.subheader(TR["product_block"])

if "products" not in st.session_state:
    st.session_state["products"] = []

col1, col2 = st.columns([3, 2])

with col1:
    product_name = st.text_input(TR["product_name"])

with col2:
    price = st.number_input(TR["price_label"], min_value=0.0, step=100.0, value=0.0)

var_text = st.text_area(
    TR["var_items_label"],
    height=140,
    placeholder="“±–Ω = 1000\n—à–µ–∫–µ—Ä = 200\n–∂“±–º—ã—Ä—Ç“õ–∞ = 300" if LANG == "“ö–∞–∑–∞“õ—à–∞"
    else "–º—É–∫–∞ = 1000\n—Å–∞—Ö–∞—Ä = 200\n—è–π—Ü–∞ = 300"
)

st.markdown(f"_{TR['var_help']}_")

var_total, var_items = parse_cost_lines(var_text)
st.info(f"{TR['var_total']} **{var_total:.0f} ‚Ç∏**")

if st.button(TR["save_product"], type="primary"):
    if product_name and price > 0 and var_total >= 0:
        st.session_state["products"].append(
            {
                "name": product_name,
                "variable_cost": var_total,
                "price": price,
            }
        )
        st.success(TR["saved_ok"])
    else:
        st.error(TR["saved_error"])

# –ö–µ—Å—Ç–µ
products_df = pd.DataFrame(st.session_state["products"])
if not products_df.empty:
    st.subheader(TR["products_table"])
    show_df = products_df.copy()
    show_df.columns = ["”®–Ω—ñ–º / –¢–æ–≤–∞—Ä", "–ê–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω (1 –¥–∞–Ω–∞)", "–ë–∞“ì–∞ (1 –¥–∞–Ω–∞)"]
    st.table(show_df)

st.markdown("---")

# -------------------------
# 2-“õ–∞–¥–∞–º: –¢“±—Ä–∞“õ—Ç—ã —à—ã“ì—ã–Ω–¥–∞—Ä
# -------------------------
st.subheader(TR["fixed_block"])

fixed_text = st.text_area(
    TR["fixed_items_label"],
    height=140,
    placeholder="–∞—Ä–µ–Ω–¥–∞ = 150000\n–∂–∞–ª–∞“õ—ã = 200000\n–∫–æ–º–º—É–Ω–∞–ª–¥—ã“õ = 50000"
    if LANG == "“ö–∞–∑–∞“õ—à–∞"
    else "–∞—Ä–µ–Ω–¥–∞ = 150000\n–∑–∞—Ä–ø–ª–∞—Ç–∞ = 200000\n–∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ = 50000",
    key="fixed_text",
)

st.markdown(f"_{TR['fixed_help']}_")

fixed_total, fixed_items = parse_cost_lines(fixed_text)
st.info(f"{TR['fixed_total']} **{fixed_total:.0f} ‚Ç∏**")

st.markdown("---")

# -------------------------
# 3-“õ–∞–¥–∞–º: –ì—Ä–∞—Ñ–∏–∫ –∂”ô–Ω–µ —Ç–∞–ª–¥–∞—É
# -------------------------
st.subheader(TR["graph_block"])

if products_df.empty:
    st.info(TR["no_products"])
elif fixed_total <= 0:
    st.info(TR["no_fixed"])
else:
    # ”©–Ω—ñ–º —Ç–∞“£–¥–∞—É
    product_names = [p["name"] for p in st.session_state["products"]]
    selected_name = st.selectbox(TR["select_product"], product_names)
    st.write(TR["info_select"])

    product = next(p for p in st.session_state["products"] if p["name"] == selected_name)
    p_price = product["price"]
    p_vc = product["variable_cost"]

    if p_price <= p_vc:
        st.error(TR["bad_price"])
    else:
        # –ó–∞–ª–∞–ª—Å—ã–∑–¥—ã“õ –Ω“Ø–∫—Ç–µ—Å—ñ
        break_even_units = fixed_total / (p_price - p_vc)

        # –ì—Ä–∞—Ñ–∏–∫ –¥–∏–∞–ø–∞–∑–æ–Ω—ã
        max_units = int(max(break_even_units * 2, break_even_units + 10, 20))
        units = list(range(0, max_units + 1))
        revenue = [u * p_price for u in units]
        total_cost = [fixed_total + u * p_vc for u in units]

        fig = go.Figure()
        fig.add_trace(
            go.Scatter(x=units, y=revenue, name=TR["revenue"])
        )
        fig.add_trace(
            go.Scatter(x=units, y=total_cost, name=TR["total_cost"])
        )

        fig.add_vline(
            x=break_even_units,
            line_width=2,
            line_dash="dash",
            line_color="red",
            annotation_text=TR["break_even"],
            annotation_position="top left",
        )

        fig.update_layout(
            title=f"{TR['graph_title']} ‚Äì {selected_name}",
            xaxis_title=TR["units"],
            yaxis_title="‚Ç∏",
            legend=dict(orientation="h", yanchor="bottom", y=1.02, xanchor="right", x=1),
        )

        st.plotly_chart(fig, use_container_width=True)

        # -------------------------
        # –ñ–ò-—Å—Ç–∏–ª—å –∫–µ“£–µ—Å—Ç–µ—Ä
        # -------------------------
        st.subheader(TR["advice_block"])
        st.write(TR["advice_intro"])

        # 1) –ù–µ–≥—ñ–∑–≥—ñ –∑–∞–ª–∞–ª—Å—ã–∑–¥—ã“õ –Ω“Ø–∫—Ç–µ—Å—ñ
        st.markdown(TR["bep_sentence"].format(q=break_even_units))

        # 2) –ë–∞“ì–∞–Ω—ã 10% ”©—Å—ñ—Ä–≥–µ–Ω–¥–µ–≥—ñ BEP
        new_price = p_price * 1.10
        if new_price > p_vc:
            new_bep = fixed_total / (new_price - p_vc)
            st.markdown(
                TR["bep_price_up"].format(
                    old_price=p_price,
                    new_price=new_price,
                    old_q=break_even_units,
                    new_q=new_bep,
                )
            )

        # 3) –ú–∏–Ω–∏–º–∞–ª–¥—ã –±–∞“ì–∞ (–∞–π–Ω—ã–º–∞–ª—ã —à—ã“ì—ã–Ω + 10%)
        min_price = p_vc * 1.10
        st.markdown(TR["bep_min_price"].format(min_price=min_price))

        # 4) –¢–∏—ñ–º–¥—ñ –±–∞“ì–∞ –¥–∏–∞–ø–∞–∑–æ–Ω—ã
        low = max(min_price, p_price * 0.9)
        high = p_price * 1.2
        st.markdown(TR["bep_range"].format(low=low, high=high))
